<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>4x 8-bit Visualizers (Bipolar + Unipolar)</title>
  <style>
    body {
      margin: 0;
      background: #111;
      font-family: sans-serif;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
      padding: 20px;
    }

    .visualizer {
      background: #222;
      border: 1px solid #D4AF37;
      border-radius: 6px;
      padding: 12px;
      width: 220px;
      box-shadow: 0 0 10px rgba(0,0,0,0.8);
    }

    .bits {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .bit {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: black;
      transition: background 0.1s ease;
    }

    svg {
      width: 100%;
      height: 40px;
      display: block;
      background: #111;
    }
  </style>
</head>
<body>

<!-- Four stacked visualizers -->
<div class="visualizer">
  <div class="bits" id="bits-1"></div>
  <svg id="sparkline-1" viewBox="0 0 220 40" preserveAspectRatio="none">
    <g id="baseline-1"></g>
    <g id="sparkline-path-1"></g>
  </svg>
</div>

<div class="visualizer">
  <div class="bits" id="bits-2"></div>
  <svg id="sparkline-2" viewBox="0 0 220 40" preserveAspectRatio="none">
    <g id="baseline-2"></g>
    <g id="sparkline-path-2"></g>
  </svg>
</div>

<div class="visualizer">
  <div class="bits" id="bits-3"></div>
  <svg id="sparkline-3" viewBox="0 0 220 40" preserveAspectRatio="none">
    <g id="baseline-3"></g>
    <g id="sparkline-path-3"></g>
  </svg>
</div>

<div class="visualizer">
  <div class="bits" id="bits-4"></div>
  <svg id="sparkline-4" viewBox="0 0 220 40" preserveAspectRatio="none">
    <g id="baseline-4"></g>
    <g id="sparkline-path-4"></g>
  </svg>
</div>

<script>
function createVisualizer(id, bipolar = false) {
  const bitContainer = document.getElementById(`bits-${id}`);
  const pathContainer = document.getElementById(`sparkline-path-${id}`);
  const baselineContainer = document.getElementById(`baseline-${id}`);

  const bits = [];
  for (let i = 0; i < 8; i++) {
    const bit = document.createElement('div');
    bit.className = 'bit';
    bitContainer.appendChild(bit);
    bits.push(bit);
  }

  const history = new Array(32).fill(0);
  let value = Math.floor(Math.random() * 256); // initial seed

  const w = 220;
  const h = 40;
  const step = w / 31;

  // Draw baseline once
  const baselineY = bipolar
    ? h - ((127 / 255) * h)
    : h; // 0 for unipolar (bottom line)
  const baselinePath = document.createElementNS("http://www.w3.org/2000/svg", "line");
  baselinePath.setAttribute("x1", "0");
  baselinePath.setAttribute("x2", w);
  baselinePath.setAttribute("y1", baselineY);
  baselinePath.setAttribute("y2", baselineY);
  baselinePath.setAttribute("stroke", "#555");
  baselinePath.setAttribute("stroke-width", "1");
  baselinePath.setAttribute("stroke-dasharray", "2,2");
  baselineContainer.appendChild(baselinePath);

  function drawBits(val) {
    for (let i = 0; i < 8; i++) {
      const isSet = (val & (1 << (7 - i))) !== 0;
      bits[i].style.background = isSet ? 'red' : 'black';
    }
  }

  function drawSparkline() {
    pathContainer.innerHTML = '';

    for (let i = 0; i < 31; i++) {
      const v1 = history[i];
      const v2 = history[i + 1];
      const x1 = i * step;
      const x2 = (i + 1) * step;
      const y1 = h - (v1 / 255) * h;
      const y2 = h - (v2 / 255) * h;

      const fade = i / 31;
      const gray = Math.round(fade * 255);
      const color = `rgb(${gray},${gray},${gray})`;

      const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
      path.setAttribute("stroke", color);
      path.setAttribute("stroke-width", "2");
      path.setAttribute("fill", "none");
      path.setAttribute("d", `M${x1},${y1} H${x2} V${y2}`);
      pathContainer.appendChild(path);
    }
  }

  function rotateLeft(val) {
    return ((val << 1) | (val >> 7)) & 0xFF;
  }

  function update() {
    drawBits(value);
    history.push(value);
    if (history.length > 32) history.shift();
    drawSparkline();
    value = rotateLeft(value);
  }

  return { update };
}

// Create 4 visualizers: top two bipolar, bottom two unipolar
const viz1 = createVisualizer(1, true);
const viz2 = createVisualizer(2, true);
const viz3 = createVisualizer(3, false);
const viz4 = createVisualizer(4, false);

// Step them forward
setInterval(() => {
  viz1.update();
  viz2.update();
  viz3.update();
  viz4.update();
}, 125);
</script>

</body>
</html>
